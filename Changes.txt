mainly replacing cl with cl lib :
 (require 'cl-lib)

cl-defmethod
cl-typecase
cl-case

changes to remove warnings

and I started to remove XEmacs code
- if you agree to that I can continue
